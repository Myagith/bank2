{% extends 'base.html' %}
{% block title %}Mes opérations{% endblock %}
{% block content %}
<h2>Mes opérations</h2>
<div class="card" style="margin-bottom:12px">
  <form method="get" class="filters" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:8px; align-items:end">
    <div><label>Type</label><input type="text" name="type" value="{{ request.GET.type }}"></div>
    <div><label>Date ≥</label><input type="date" name="created_at__date__gte" value="{{ request.GET.created_at__date__gte }}"></div>
    <div><label>Date ≤</label><input type="date" name="created_at__date__lte" value="{{ request.GET.created_at__date__lte }}"></div>
    <div><label>Montant ≥</label><input type="number" step="0.01" name="amount__gte" value="{{ request.GET.amount__gte }}"></div>
    <div><label>Montant ≤</label><input type="number" step="0.01" name="amount__lte" value="{{ request.GET.amount__lte }}"></div>
    <div><button class="btn" type="submit">Filtrer</button></div>
  </form>
  <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap">
    <a class="btn" href="/transactions/create/">Nouvelle opération</a>
    <a class="btn" href="/transactions/export/csv/">Exporter CSV</a>
    <a class="btn" href="/transactions/export/xlsx/">Exporter Excel</a>
    <a class="btn" href="/transactions/export/pdf/">Exporter PDF</a>
  </div>
  </div>

<table class="table">
  <thead><tr><th>Date</th><th>Type</th><th>Montant</th><th>Compte</th><th>Référence</th></tr></thead>
  <tbody>
  {% for t in transactions %}
    <tr>
      <td>{{ t.created_at|date:'Y-m-d H:i' }}</td>
      <td><span class="badge" style="background:{% if t.type == 'DEPOSIT' %}#e6fff7{% elif t.type == 'WITHDRAW' %}#ffecf0{% else %}#eef{% endif %}">{{ t.type }}</span></td>
      <td>{{ t.amount }}</td>
      <td>{{ t.account.number }}</td>
      <td>{{ t.reference }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="5">Aucune donnée</td></tr>
  {% endfor %}
  </tbody>
  </table>
{% endblock %}

