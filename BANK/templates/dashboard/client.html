{% extends 'base.html' %}
{% load static %}
{% block title %}Dashboard Client{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard/client.css' %}">
{% endblock %}

{% block content %}
<h2>Dashboard Client</h2>

<div class="cards">
  <!-- Solde principal -->
  <div class="card">
      <h3>Solde de votre compte principal</h3>
      <p class="metric">{{ main_account_balance }} FCFA</p>
  </div>

  <!-- Nombre de comptes -->
  <div class="card">
      <h3>Nombre de comptes</h3>
      <p class="metric">{{ accounts_count }}</p>
  </div>

  <!-- Graphique dépenses / dépôts -->
  <div class="card">
      <h3>Répartition Dépenses / Dépôts</h3>
      <canvas id="expensesDepositsPie"></canvas>
  </div>
</div>

<!-- Transactions récentes -->
<div class="card">
    <h3>Transactions récentes</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Montant</th>
                <th>Type</th>
            </tr>
        </thead>
        <tbody>
            {% for t in recent_transactions %}
            <tr>
                <td>{{ t.created_at|date:"d/m/Y H:i" }}</td>
                <td>{{ t.amount }}</td>
                <td>{{ t.type }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3">Aucune transaction récente</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Graphique dépenses sur les derniers jours -->
<div class="card">
    <h3>Dépenses sur les derniers jours</h3>
    <canvas id="expensesChart"></canvas>
</div>

{{ client_dashboard_data|json_script:"client-dashboard-data" }}
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/dashboard/client.js' %}"></script>
{% endblock %}